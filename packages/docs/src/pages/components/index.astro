---
import StarlightPage from '@astrojs/starlight/components/StarlightPage.astro'

// Helper to get image path - uses .gif for animated components, .png otherwise
const getImage = (slug: string) => {
  const animated = ['carousel', 'countdown', 'loading', 'textrotate']
  const ext = animated.includes(slug) ? 'gif' : 'png'
  return `/components/${slug}.${ext}`
}

const categories = [
  {
    name: 'Actions',
    components: [
      { name: 'Button', slug: 'button', description: 'Trigger actions with various styles and states.' },
      { name: 'CopyButton', slug: 'copybutton', description: 'One-click copy to clipboard.' },
      { name: 'Dropdown', slug: 'dropdown', description: 'Toggleable menu for actions or navigation.' },
      { name: 'FloatButton', slug: 'floatbutton', description: 'Floating action button for primary actions.' },
    ],
  },
  {
    name: 'Data Display',
    components: [
      { name: 'Avatar', slug: 'avatar', description: 'Display user profile images or initials.' },
      { name: 'Badge', slug: 'badge', description: 'Small status indicators and counters.' },
      { name: 'Card', slug: 'card', description: 'Container for related content and actions.' },
      { name: 'Carousel', slug: 'carousel', description: 'Cycle through images or content.' },
      { name: 'Chart', slug: 'chart', description: 'Data visualization with ApexCharts.' },
      { name: 'Chat', slug: 'chat', description: 'Chat bubbles for messaging interfaces.' },
      { name: 'Collapse', slug: 'collapse', description: 'Expandable content panels.' },
      { name: 'Countdown', slug: 'countdown', description: 'Animated countdown timer.' },
      { name: 'Descriptions', slug: 'descriptions', description: 'Display key-value pairs in a list.' },
      { name: 'Diff', slug: 'diff', description: 'Show differences between two items.' },
      { name: 'Empty', slug: 'empty', description: 'Placeholder for empty states.' },
      { name: 'HoverGallery', slug: 'hovergallery', description: 'Image gallery with hover effects.' },
      { name: 'Image', slug: 'image', description: 'Enhanced image with preview and fallback.' },
      { name: 'List', slug: 'list', description: 'Display collections of items.' },
      { name: 'VirtualList', slug: 'virtuallist', description: 'Efficiently render large lists.' },
      { name: 'MonthCalendar', slug: 'monthcalendar', description: 'Monthly calendar view.' },
      { name: 'Popover', slug: 'popover', description: 'Floating content on hover or click.' },
      { name: 'QRCode', slug: 'qrcode', description: 'Generate scannable QR codes.' },
      { name: 'Stat', slug: 'stat', description: 'Display statistics and metrics.' },
      { name: 'Status', slug: 'status', description: 'Show online/offline or custom status.' },
      { name: 'Table', slug: 'table', description: 'Display tabular data with sorting and selection.' },
      { name: 'Tag', slug: 'tag', description: 'Categorize content with labels.' },
      { name: 'Timeline', slug: 'timeline', description: 'Display events in chronological order.' },
      { name: 'Tooltip', slug: 'tooltip', description: 'Show additional info on hover.' },
      { name: 'Tree', slug: 'tree', description: 'Hierarchical data display.' },
      { name: 'WeekCalendar', slug: 'weekcalendar', description: 'Weekly calendar view.' },
    ],
  },
  {
    name: 'Data Entry',
    components: [
      { name: 'Autocomplete', slug: 'autocomplete', description: 'Input with suggestion dropdown.' },
      { name: 'Cascader', slug: 'cascader', description: 'Multi-level selection dropdown.' },
      { name: 'Checkbox', slug: 'checkbox', description: 'Multiple selection control.' },
      { name: 'ColorPicker', slug: 'colorpicker', description: 'Select colors visually.' },
      { name: 'DatePicker', slug: 'datepicker', description: 'Select dates from a calendar.' },
      { name: 'Fieldset', slug: 'fieldset', description: 'Group related form fields.' },
      { name: 'FileInput', slug: 'fileinput', description: 'File selection input.' },
      { name: 'Filter', slug: 'filter', description: 'Filter data with multiple criteria.' },
      { name: 'Form', slug: 'form', description: 'Form handling with validation.' },
      { name: 'Input', slug: 'input', description: 'Text input field.' },
      { name: 'InputNumber', slug: 'inputnumber', description: 'Numeric input with controls.' },
      { name: 'Mention', slug: 'mention', description: 'Input with @mention support.' },
      { name: 'OTPInput', slug: 'otpinput', description: 'One-time password input.' },
      { name: 'Radio', slug: 'radio', description: 'Single selection from options.' },
      { name: 'Range', slug: 'range', description: 'Select value from a range.' },
      { name: 'Rating', slug: 'rating', description: 'Star-based rating input.' },
      { name: 'RichTextEditor', slug: 'richtexteditor', description: 'WYSIWYG text editor.' },
      { name: 'Segmented', slug: 'segmented', description: 'Segmented control for switching.' },
      { name: 'Select', slug: 'select', description: 'Dropdown selection.' },
      { name: 'Textarea', slug: 'textarea', description: 'Multi-line text input.' },
      { name: 'TimePicker', slug: 'timepicker', description: 'Select time values.' },
      { name: 'Toggle', slug: 'toggle', description: 'On/off switch control.' },
      { name: 'Transfer', slug: 'transfer', description: 'Move items between lists.' },
      { name: 'TreeSelect', slug: 'treeselect', description: 'Select from hierarchical options.' },
      { name: 'Upload', slug: 'upload', description: 'File upload with drag and drop.' },
    ],
  },
  {
    name: 'Feedback',
    components: [
      { name: 'Alert', slug: 'alert', description: 'Display important messages.' },
      { name: 'Drawer', slug: 'drawer', description: 'Slide-out panel from edge.' },
      { name: 'Loading', slug: 'loading', description: 'Loading indicators and spinners.' },
      { name: 'Message', slug: 'message', description: 'Brief feedback messages.' },
      { name: 'Modal', slug: 'modal', description: 'Dialog overlays for focus.' },
      { name: 'Notification', slug: 'notification', description: 'Toast notifications.' },
      { name: 'Popconfirm', slug: 'popconfirm', description: 'Confirmation before action.' },
      { name: 'Progress', slug: 'progress', description: 'Show completion progress.' },
      { name: 'RadialProgress', slug: 'radialprogress', description: 'Circular progress indicator.' },
      { name: 'Result', slug: 'result', description: 'Display operation outcomes.' },
      { name: 'Skeleton', slug: 'skeleton', description: 'Loading placeholder shapes.' },
    ],
  },
  {
    name: 'Navigation',
    components: [
      { name: 'Anchor', slug: 'anchor', description: 'Navigate to page sections.' },
      { name: 'Breadcrumb', slug: 'breadcrumb', description: 'Show navigation hierarchy.' },
      { name: 'Command', slug: 'command', description: 'Command palette for quick actions.' },
      { name: 'ContextMenu', slug: 'contextmenu', description: 'Right-click menu.' },
      { name: 'Dock', slug: 'dock', description: 'macOS-style dock navigation.' },
      { name: 'Menu', slug: 'menu', description: 'Vertical navigation menu.' },
      { name: 'Navbar', slug: 'navbar', description: 'Top navigation bar.' },
      { name: 'Pagination', slug: 'pagination', description: 'Navigate through pages.' },
      { name: 'ResponsiveDrawer', slug: 'responsivedrawer', description: 'Responsive sidebar navigation.' },
      { name: 'Steps', slug: 'steps', description: 'Step-by-step progress indicator.' },
      { name: 'Tabs', slug: 'tabs', description: 'Tabbed content navigation.' },
    ],
  },
  {
    name: 'Layout',
    components: [
      { name: 'Container', slug: 'container', description: 'Centered content wrapper.' },
      { name: 'Divider', slug: 'divider', description: 'Separate content sections.' },
      { name: 'Flex', slug: 'flex', description: 'Flexbox layout helper.' },
      { name: 'Footer', slug: 'footer', description: 'Page footer component.' },
      { name: 'Grid', slug: 'grid', description: 'Responsive grid layout.' },
      { name: 'Hero', slug: 'hero', description: 'Hero section for landing pages.' },
      { name: 'Join', slug: 'join', description: 'Group elements together.' },
      { name: 'Layout', slug: 'layout', description: 'Page layout structure.' },
      { name: 'Masonry', slug: 'masonry', description: 'Pinterest-style grid layout.' },
      { name: 'Responsive', slug: 'responsive', description: 'Show/hide by breakpoint.' },
      { name: 'Space', slug: 'space', description: 'Add consistent spacing.' },
      { name: 'Splitter', slug: 'splitter', description: 'Resizable split panels.' },
    ],
  },
  {
    name: 'Other',
    components: [
      { name: 'Affix', slug: 'affix', description: 'Stick element to viewport.' },
      { name: 'Browser', slug: 'browser', description: 'Browser window mockup.' },
      { name: 'Code', slug: 'code', description: 'Display code snippets.' },
      { name: 'ConfigProvider', slug: 'configprovider', description: 'Global configuration.' },
      { name: 'Kbd', slug: 'kbd', description: 'Keyboard key display.' },
      { name: 'Mask', slug: 'mask', description: 'Apply image masks.' },
      { name: 'Phone', slug: 'phone', description: 'Phone device mockup.' },
      { name: 'TextRotate', slug: 'textrotate', description: 'Animated rotating text.' },
      { name: 'ThemeController', slug: 'themecontroller', description: 'Theme switching control.' },
      { name: 'Tour', slug: 'tour', description: 'Guided product tours.' },
      { name: 'Typography', slug: 'typography', description: 'Text styling components.' },
      { name: 'Watermark', slug: 'watermark', description: 'Add watermarks to content.' },
      { name: 'Window', slug: 'window', description: 'Window frame mockup.' },
    ],
  },
]

const totalComponents = categories.reduce((acc, cat) => acc + cat.components.length, 0)
---

<StarlightPage
  frontmatter={{
    title: 'Overview',
    description: `Browse all ${totalComponents} components in AsterUI.`,
    tableOfContents: false,
  }}
>
  <div class="sl-markdown-content">
    <p class="text-lg mb-8">
      AsterUI provides {totalComponents} components built on DaisyUI and Tailwind CSS.
    </p>

    <div class="search-box mb-8">
      <input
        type="text"
        id="component-search"
        placeholder="Search components..."
        class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-transparent"
      />
    </div>

    {categories.map((category) => (
      <section class="category-section mb-10" data-category={category.name}>
        <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
          {category.name}
          <span class="text-sm font-normal text-gray-500">({category.components.length})</span>
        </h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4">
          {category.components.map((comp) => (
            <a
              href={`/components/${comp.slug}`}
              class="component-card block p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-indigo-500 dark:hover:border-indigo-400 hover:shadow-md transition-all"
              data-name={comp.name.toLowerCase()}
              data-description={comp.description.toLowerCase()}
            >
              <h3 class="font-medium mb-1">{comp.name}</h3>
              <p class="text-sm text-gray-500 dark:text-gray-400 mb-3">{comp.description}</p>
              <div class="h-16 flex items-center justify-center">
                <img src={getImage(comp.slug)} alt={comp.name} class="max-h-full max-w-full object-contain" />
              </div>
            </a>
          ))}
        </div>
      </section>
    ))}
  </div>

  <script>
    // Add wide layout class
    document.body.classList.add('components-overview')

    const searchInput = document.getElementById('component-search') as HTMLInputElement
    const cards = document.querySelectorAll('.component-card')
    const sections = document.querySelectorAll('.category-section')

    searchInput?.addEventListener('input', (e) => {
      const query = (e.target as HTMLInputElement).value.toLowerCase()

      cards.forEach((card) => {
        const name = card.getAttribute('data-name') || ''
        const description = card.getAttribute('data-description') || ''
        const matches = name.includes(query) || description.includes(query)
        ;(card as HTMLElement).style.display = matches ? '' : 'none'
      })

      // Hide empty sections
      sections.forEach((section) => {
        const visibleCards = section.querySelectorAll('.component-card:not([style*="display: none"])')
        ;(section as HTMLElement).style.display = visibleCards.length > 0 ? '' : 'none'
      })
    })
  </script>
</StarlightPage>
