---
import Layout from '../../layouts/Layout.astro';
import ApiTable from '../../components/ApiTable.astro';
import { Code } from 'astro:components';

const showHideApi = [
  { property: 'children', description: 'Content to show/hide', type: 'ReactNode', default: '-' },
  { property: 'above', description: 'Show/hide at this breakpoint and above', type: "Breakpoint", default: '-' },
  { property: 'below', description: 'Show/hide below this breakpoint', type: "Breakpoint", default: '-' },
  { property: 'at', description: 'Show/hide at exactly this breakpoint (or array of breakpoints)', type: "Breakpoint | Breakpoint[]", default: '-' },
  { property: 'between', description: 'Show/hide between two breakpoints (inclusive)', type: "[Breakpoint, Breakpoint]", default: '-' },
];

const hookReturnApi = [
  { property: 'breakpoint', description: 'Current active breakpoint', type: "Breakpoint", default: '-' },
  { property: 'width', description: 'Current window width in pixels', type: "number", default: '-' },
  { property: 'isAbove(bp)', description: 'Returns true if current breakpoint >= bp', type: "(bp: Breakpoint) => boolean", default: '-' },
  { property: 'isBelow(bp)', description: 'Returns true if current breakpoint < bp', type: "(bp: Breakpoint) => boolean", default: '-' },
  { property: 'isAt(bp)', description: 'Returns true if current breakpoint === bp', type: "(bp: Breakpoint) => boolean", default: '-' },
  { property: 'isBetween(min, max)', description: 'Returns true if current breakpoint is between min and max (inclusive)', type: "(min: Breakpoint, max: Breakpoint) => boolean", default: '-' },
];

const breakpointsTable = [
  { property: 'xs', description: 'Extra small screens', type: '0px', default: '-' },
  { property: 'sm', description: 'Small screens', type: '640px', default: '-' },
  { property: 'md', description: 'Medium screens', type: '768px', default: '-' },
  { property: 'lg', description: 'Large screens', type: '1024px', default: '-' },
  { property: 'xl', description: 'Extra large screens', type: '1280px', default: '-' },
  { property: '2xl', description: 'Double extra large screens', type: '1536px', default: '-' },
];

const examples = [
  {
    id: 'show-above',
    title: 'Show Above Breakpoint',
    description: 'Show content only at medium screens and above.',
    code: `import React from 'react'
import { Show, Button } from 'asterui'

const App: React.FC = () => (
  <Show above="md">
    <Button color="primary">Visible on md and larger</Button>
  </Show>
)

export default App`,
  },
  {
    id: 'hide-below',
    title: 'Hide Below Breakpoint',
    description: 'Hide content on small screens.',
    code: `import React from 'react'
import { Hide, Navbar } from 'asterui'

const App: React.FC = () => (
  <Hide below="md">
    <Navbar>Desktop Navigation</Navbar>
  </Hide>
)

export default App`,
  },
  {
    id: 'show-at',
    title: 'Show At Specific Breakpoints',
    description: 'Show content only at specific breakpoints.',
    code: `import React from 'react'
import { Show, Alert } from 'asterui'

const App: React.FC = () => (
  <>
    <Show at="xs">
      <Alert type="info">Mobile view only</Alert>
    </Show>
    <Show at={['md', 'lg']}>
      <Alert type="success">Tablet or small desktop</Alert>
    </Show>
  </>
)

export default App`,
  },
  {
    id: 'show-between',
    title: 'Show Between Breakpoints',
    description: 'Show content within a range of breakpoints.',
    code: `import React from 'react'
import { Show, Card } from 'asterui'

const App: React.FC = () => (
  <Show between={['sm', 'lg']}>
    <Card title="Responsive Content">
      Visible on sm, md, and lg screens only
    </Card>
  </Show>
)

export default App`,
  },
  {
    id: 'responsive-layout',
    title: 'Responsive Layout',
    description: 'Build different layouts for mobile and desktop.',
    code: `import React from 'react'
import { Show, Hide, Menu, Button, Flex } from 'asterui'

const App: React.FC = () => (
  <Flex justify="between" align="center" className="p-4 bg-base-200">
    <div className="font-bold">Logo</div>

    {/* Desktop navigation */}
    <Show above="md">
      <Flex gap="md">
        <Button variant="ghost">Home</Button>
        <Button variant="ghost">About</Button>
        <Button variant="ghost">Contact</Button>
      </Flex>
    </Show>

    {/* Mobile menu button */}
    <Hide above="md">
      <Button variant="ghost">Menu</Button>
    </Hide>
  </Flex>
)

export default App`,
  },
  {
    id: 'use-breakpoint',
    title: 'useBreakpoint Hook',
    description: 'Access breakpoint info programmatically.',
    code: `import React from 'react'
import { useBreakpoint, Card, Typography } from 'asterui'

const { Text } = Typography

const App: React.FC = () => {
  const { breakpoint, width, isAbove, isBelow } = useBreakpoint()

  return (
    <Card title="Current Breakpoint">
      <Text>Breakpoint: {breakpoint}</Text>
      <Text>Width: {width}px</Text>
      <Text>Is desktop: {isAbove('lg') ? 'Yes' : 'No'}</Text>
      <Text>Is mobile: {isBelow('md') ? 'Yes' : 'No'}</Text>
    </Card>
  )
}

export default App`,
  },
];
---

<Layout title="Responsive - AsterUI">
  <div>
    <div class="mb-8">
      <nav class="text-sm breadcrumbs mb-4">
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/components">Components</a></li>
          <li>Responsive</li>
        </ul>
      </nav>
      <h1 class="text-4xl font-bold mb-2">Responsive Utilities</h1>
      <p class="text-base-content/70 text-lg">Components and hooks for building responsive layouts based on screen size.</p>
    </div>

    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Import</h2>
      <div class="border border-base-300 rounded-lg overflow-hidden [&_pre]:!m-0 [&_pre]:!rounded-none">
        <Code code={`import { Show, Hide, useBreakpoint } from 'asterui'
import type { Breakpoint } from 'asterui'`} lang="tsx" themes={{ light: 'github-light', dark: 'github-dark' }} defaultColor={false} />
      </div>
    </section>

    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Breakpoints</h2>
      <p class="text-base-content/70 mb-4">AsterUI uses the same breakpoints as Tailwind CSS:</p>
      <ApiTable title="Breakpoint Values" data={breakpointsTable} />
    </section>

    <section class="mb-12">
      <h2 class="text-2xl font-bold mb-6">Examples</h2>
      <div class="columns-1 lg:columns-2 gap-6">
      {examples.map((example) => (
        <div class="example-card mb-6 border border-base-300 rounded-lg break-inside-avoid">
          <div class="p-4 bg-base-100 rounded-t-lg">
            <h3 class="text-lg font-semibold mb-1">{example.title}</h3>
            <p class="text-sm text-base-content/70 mb-4">{example.description}</p>
            <div class="demo-container" data-example={example.id}></div>
          </div>
          <div class="border-t border-base-300 flex justify-center bg-base-200 rounded-b-lg">
            <div class="tooltip tooltip-top" data-tip="Show code">
              <button class="toggle-code btn btn-ghost btn-sm font-mono">&lt;&#8201;&gt;</button>
            </div>
          </div>
          <div class="code-panel relative" aria-hidden="true">
            <button class="copy-btn absolute top-2 right-2 btn btn-xs btn-ghost z-10" data-code={example.code}>
              <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
            </button>
            <div class="[&_pre]:!p-4 [&_pre]:!rounded-none [&_pre]:!m-0 text-sm">
              <Code code={example.code} lang="tsx" themes={{ light: 'github-light', dark: 'github-dark' }} defaultColor={false} />
            </div>
          </div>
        </div>
      ))}
      </div>
    </section>

    <section class="mb-12">
      <h2 class="text-2xl font-bold mb-6">API</h2>
      <ApiTable title="Show / Hide Props" data={showHideApi} />
      <div class="mt-8">
        <ApiTable title="useBreakpoint Return Value" data={hookReturnApi} />
      </div>
    </section>

    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Notes</h2>
      <ul class="list-disc list-inside space-y-2 text-base-content/80">
        <li><code>Show</code> and <code>Hide</code> use JavaScript to detect the breakpoint, not CSS media queries</li>
        <li>Only one condition prop (<code>above</code>, <code>below</code>, <code>at</code>, or <code>between</code>) should be used at a time</li>
        <li>The hook updates on window resize to track the current breakpoint</li>
        <li>Server-side rendering defaults to 1024px width (lg breakpoint)</li>
      </ul>
    </section>
  </div>
</Layout>

<style>
  .code-panel { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
  .example-card.open .code-panel { max-height: 2000px; }
</style>

<script>
  import '../../scripts/responsiveDemos.tsx';
  document.querySelectorAll('.toggle-code').forEach(btn => {
    btn.addEventListener('click', () => {
      const card = btn.closest('.example-card');
      if (card) {
        card.classList.toggle('open');
        const panel = card.querySelector('.code-panel');
        const tooltip = btn.closest('.tooltip');
        if (card.classList.contains('open')) {
          panel?.setAttribute('aria-hidden', 'false');
          tooltip?.setAttribute('data-tip', 'Hide code');
        } else {
          panel?.setAttribute('aria-hidden', 'true');
          tooltip?.setAttribute('data-tip', 'Show code');
        }
      }
    });
  });
  document.querySelectorAll('.copy-btn').forEach(btn => {
    btn.addEventListener('click', async () => {
      const code = btn.getAttribute('data-code');
      if (code) {
        await navigator.clipboard.writeText(code);
        btn.classList.add('btn-success');
        setTimeout(() => btn.classList.remove('btn-success'), 1000);
      }
    });
  });
</script>
