---
interface Props {
  title: string
}

const { title } = Astro.props
---

<div class="example-card">
  <div class="example-header">
    <h3>{title}</h3>
    <button class="toggle-code" aria-label="Toggle code">
      <span>&lt;/&gt;</span>
    </button>
  </div>
  <slot name="demo" />
  <div class="example-code">
    <slot name="code" />
  </div>
</div>

<style is:global>
  .example-card {
    break-inside: avoid;
    margin-bottom: 1.5rem;
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 0.5rem;
    overflow: hidden;
  }

  .example-card > astro-island > div {
    margin: 0 !important;
    padding: 0 !important;
  }

  .example-card > .example-code {
    margin: 0 !important;
  }

  .example-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0.75rem;
    border-bottom: 1px solid var(--sl-color-gray-5);
    background: var(--sl-color-gray-6);
  }

  .example-header h3 {
    margin: 0;
    font-size: 0.875rem;
    font-weight: 600;
  }

  .toggle-code {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.25rem 0.5rem;
    font-family: monospace;
    font-size: 0.875rem;
    color: var(--sl-color-gray-2);
    border-radius: 0.25rem;
  }

  .toggle-code:hover {
    background: var(--sl-color-gray-5);
  }

  .example-code {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-out;
  }

  .example-card.open .example-code {
    max-height: 1000px;
  }

  .example-code .expressive-code {
    margin: 0;
    border-radius: 0;
  }

  .example-code pre {
    border-radius: 0;
  }
</style>

<script>
  document.querySelectorAll('.toggle-code').forEach(btn => {
    btn.addEventListener('click', () => {
      const card = btn.closest('.example-card')
      card?.classList.toggle('open')
    })
  })
</script>
