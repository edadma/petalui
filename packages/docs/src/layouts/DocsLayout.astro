---
/**
 * DocsLayout - For prose documentation pages (getting-started, manual-setup, etc.)
 * Narrower content width with optional "On this page" TOC
 */
import Layout from './Layout.astro';

interface TocItem {
  label: string;
  href: string;
}

interface Props {
  title: string;
  description?: string;
  toc?: TocItem[];
}

const { title, description, toc } = Astro.props;
---

<Layout title={`${title} - AsterUI`}>
  <!-- Main content - left-aligned with constrained width -->
  <article style="max-width: 56rem; margin: 0 auto;">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-4xl font-bold mb-2">{title}</h1>
      {description && (
        <p class="text-base-content/70 text-lg">{description}</p>
      )}
    </div>

    <div class="prose-content">
      <slot />
    </div>
  </article>

  <!-- TOC sidebar - fixed to right -->
  {toc && toc.length > 0 && (
    <aside class="hidden xl:block fixed top-20 right-8 w-48">
      <div class="toc-sticky">
        <h2 class="toc-title">On this page</h2>
        <nav>
          <ul class="toc-list">
            {toc.map((item) => (
              <li>
                <a href={item.href} class="toc-link">{item.label}</a>
              </li>
            ))}
          </ul>
        </nav>
      </div>
    </aside>
  )}
</Layout>

<style>
  .docs-content {
    max-width: 42rem;
  }

  .prose-content {
    line-height: 1.75;
  }

  .prose-content :global(p) {
    margin-bottom: 1.25rem;
  }

  .prose-content :global(h2) {
    font-size: 1.5rem;
    font-weight: 700;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    color: oklch(var(--bc));
  }

  .prose-content :global(h3) {
    font-size: 1.25rem;
    font-weight: 600;
    margin-top: 2rem;
    margin-bottom: 0.75rem;
    color: oklch(var(--bc));
  }

  .prose-content :global(ul),
  .prose-content :global(ol) {
    margin-bottom: 1.25rem;
    padding-left: 1.5rem;
  }

  .prose-content :global(li) {
    margin-bottom: 0.5rem;
  }

  .prose-content :global(a) {
    color: oklch(var(--p));
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .prose-content :global(a:hover) {
    color: oklch(var(--p) / 0.8);
  }

  .prose-content :global(code:not(pre code)) {
    background: oklch(var(--bc) / 0.1);
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
  }

  /* TOC styles - fixed to right side */
  .docs-toc {
    display: none;
    position: fixed;
    top: 5rem;
    right: 2rem;
    width: 12rem;
  }

  @media (min-width: 1280px) {
    .docs-toc {
      display: block;
    }
  }

  .toc-sticky {
    /* Already fixed positioned via parent */
  }

  .toc-title {
    font-size: 0.8125rem;
    font-weight: 600;
    color: oklch(var(--bc));
    margin-bottom: 1rem;
  }

  .toc-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .toc-link {
    display: block;
    padding: 0.25rem 0;
    font-size: 0.8125rem;
    color: oklch(var(--bc) / 0.5);
    text-decoration: none;
    transition: color 0.15s;
  }

  .toc-link:hover {
    color: oklch(var(--bc) / 0.8);
  }

  .toc-link.active {
    color: oklch(var(--p));
  }
</style>

<script>
  // Highlight active TOC item on scroll
  const tocLinks = document.querySelectorAll('.toc-link');
  const headings = document.querySelectorAll('.prose-content h2, .prose-content h3');

  if (tocLinks.length > 0 && headings.length > 0) {
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const id = entry.target.getAttribute('id');
            tocLinks.forEach((link) => {
              link.classList.toggle('active', link.getAttribute('href') === `#${id}`);
            });
          }
        });
      },
      { rootMargin: '-80px 0px -80% 0px' }
    );

    headings.forEach((heading) => {
      if (heading.id) {
        observer.observe(heading);
      }
    });
  }
</script>
